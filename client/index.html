<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TellApart</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@master/dist/aframe-extras.min.js"></script>
    <link rel="icon" href="favicon.png" type="image/png">
<script src="https://unpkg.com/aframe-text-geometry-component@latest/dist/aframe-text-geometry-component.min.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", function () {
      let cursor = document.querySelector("#cursor");
      let isVR = AFRAME.utils.device.isMobileVR();

      if (isVR) {
        console.log("VR");
          cursor.setAttribute("visible", "false");
          function onTriggerDown(evt) {
              let intersectedEl = evt.target.components.raycaster.intersectedEls[0];
              if (intersectedEl) {
                  
                  intersectedEl.setAttribute("material", "color: red"); // Changement de couleur
              }
          }

          document.querySelector("#rightController").addEventListener("triggerdown", onTriggerDown);
          document.querySelector("#leftController").addEventListener("triggerdown", onTriggerDown);
      } else {
        console.log("PC");
        cursor.setAttribute("visible", "true");

        cursor.addEventListener("mousedown", function (evt) {
    let intersectedEl = evt.detail.intersectedEl;
    
    if (intersectedEl && intersectedEl.classList.contains("clickable")) {
        
        intersectedEl.setAttribute("material", "color: red");
        
        // Empêche toute propagation de l'événement pour éviter des déclenchements indésirables
        evt.stopPropagation();
    } else {
        
        evt.preventDefault(); // Essaye aussi ceci pour empêcher des effets indésirables
    }
});

      }
  });
</script>

<script src="start.js" type="module"></script>

<!--<script src="start.js" type="module"></script>-->


</head>
<body>
    <a-scene>
      <!--wasd-controls="enabled: false"-->
      
      

    
              
        <a-entity id="player" position="0 0 2">
          <a-camera wasd-controls="enabled: false" look-controls="pointerLockEnabled: true">
                <a-cursor id="cursor" color="white" fuse="false" visible="false"></a-cursor>
                <script>
                if (AFRAME.utils.device.isMobileVR()) {
                  document.querySelector("#cursor").setAttribute("visible", "false");
                } else {
                  document.querySelector("#cursor").setAttribute("visible", "true");
                }
                </script>
          </a-camera>

          <!-- Manette droite avec laser -->
          <a-entity id="rightController" laser-controls="hand: right" raycaster="objects: .clickable"
              oculus-touch-controls="hand: right">
    </a-entity>

    <!-- Contrôleur gauche -->
    <a-entity id="leftController" laser-controls="hand: left" raycaster="objects: .clickable"
              oculus-touch-controls="hand: left">
    </a-entity>

        </a-entity>



        <a-assets>
            <a-asset-item id="astro" src="asset/Astronaut.glb"></a-asset-item>
            <a-asset-item id="astro1" src="asset/Astronaut1.glb"></a-asset-item>
            <a-asset-item id="astro2" src="asset/Astronaut2.glb"></a-asset-item>
            <a-asset-item id="pad" src="asset/Landing Pad.glb"></a-asset-item>
            
            <a-asset-item id="decor" src="asset/Modular Rocks.glb"></a-asset-item>
            <a-asset-item id="landerA" src="asset/Lander A.glb"></a-asset-item>
            <a-asset-item id="landerB" src="asset/Lander B.glb"></a-asset-item>
          <a-asset-item id="rocks" src="asset/Rocks.glb"></a-asset-item>  
          <a-asset-item id="spacebase" src="asset/Space Base Modules.glb"></a-assets-item>
          <a-asset-item id="tunnel" src="asset/Tunnels.glb"></a-asset-item>
          <a-asset-item id="spaceplateformA" src="asset/Platform Structure.glb"></a-asset-item>
          <a-asset-item id="spaceplateformB" src="asset/Space Platform.glb"></a-asset-item>
          <a-asset-item id="car" src="asset/Space Truck.glb"></a-asset-item>
          <a-asset-item id="light" src="asset/Lights.glb"></a-asset-item>
          <a-asset-item id="depot" src="asset/Cargo Depot A.glb"></a-asset-item>
          <a-asset-item id="cargotoit" src="asset/Cargo Roof Modules.glb"></a-asset-item>
          <a-asset-item id="cargo" src="asset/Cargo.glb"></a-asset-item>
          <a-asset-item id="planet" src="asset/Planet.glb"></a-asset-item>
          <a-asset-item id="spaceship" src="asset/Spaceship.glb"></a-asset-item>
          <a-asset-item id="alien" src="asset/Enemy Large.glb"></a-asset-item>
          <audio id="ambient" src="asset/ambient.mp3" autoplay loop></audio>
          <audio id="beamSound" src="asset/beam.mp3"></audio>
          <audio id="fail" src="asset/fail.wav"></audio>
          <audio id="success" src="asset/success.wav"></audio>
          <img id = "ciel" src = "asset/sky.png" >
          <img id = "nuage" src = "asset/nuage.png" >

        </a-assets>


      <a-entity gltf-model="#car" position="0 5.5 -35" scale="11 11 11" rotation="0 45 0"  auto-center></a-entity>
      <a-entity gltf-model="#car" position="63 0 10" scale="11 11 11" rotation="0 0 0"  auto-center></a-entity>

      <a-entity gltf-model="#planet" position="-80 80 -80" scale="7 7 7" rotation="0 0 0"  auto-center></a-entity>

          <a-entity id="drone" gltf-model="#spaceship" position="0 25 -10" scale="2 2 2" rotation="50 0 0"  auto-center></a-entity>

        

          <a-entity gltf-model="#cargo" position="-50 -1 20" scale="3 3 3" rotation="0 0 0"  auto-center></a-entity>
          
          <a-entity gltf-model="#landerA" position="20 -1 -2" scale="7 7 7" rotation="0 -90 0"  auto-center></a-entity>
          <a-entity gltf-model="#landerB" position="-20 -1 -2" scale="7 7 7" rotation="0 90 0"  auto-center></a-entity>

      <a-entity gltf-model="#rocks" position="-20 -1 195" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="20 -1 195" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="10 3.5 100" scale="3 3 3" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="-125 3.5 -22" scale="3 3 3" rotation="0 0 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="0 -1 -100" scale="3 3 3" rotation="0 -90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="10 -1 -100" scale="3 3 3" rotation="0 -90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="-22 3.5 -137" scale="3 3 3" rotation="0 -90 0" auto-center></a-entity>
      <a-entity gltf-model="#rocks" position="-2000 0 200" scale="50 50 50"  ></a-entity>
      <a-entity gltf-model="#rocks" position="-1950 0 190" scale="50 50 50"  ></a-entity>
      <a-entity gltf-model="#rocks" position="-2050 15 190" scale="50 50 50"  ></a-entity>

      <a-entity gltf-model="#rocks" position="-2000 0 -200" scale="50 50 50"  ></a-entity>
      <a-entity gltf-model="#rocks" position="-1950 0 -190" scale="50 50 50"  ></a-entity>
      <a-entity gltf-model="#rocks" position="-2050 15 -190" scale="50 50 50"  ></a-entity>

      <a-entity gltf-model="#depot" position="20 4 -20" scale="7 7 7 " rotation="0 90 0"  auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="20 2 20" target-part="basemodule_A" scale="7 7 7 " rotation="0 -90 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="20 11 20" target-part="basemodule_E" scale="7 7 7 " rotation="0 75 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="-20 2 20" target-part="basemodule_B" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="-25 2 10" target-part="basemodule_C" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="-25 9 10" target-part="basemodule_D" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="30 17 9" target-part="basemodule_D" scale="7 7 7 " rotation="0 0 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="-10 6.5 -25" target-part="basemodule_C" scale="7 7 7 " rotation="0 0 0" auto-center></a-entity>
      <a-entity gltf-model="#spacebase" position="-10 18.5 -26" target-part="basemodule_A" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>

      <a-entity gltf-model="#cargotoit" position="-19 7 20" target-part="roofmodule_solarpanels" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>

      <a-entity gltf-model="#tunnel" position="0 2 20" target-part="tunnel_diagonal_long_A" scale="7 7 7 " rotation="0 45 0" auto-center></a-entity>
      <a-entity gltf-model="#tunnel" position="-1 17 -18" target-part="tunnel_diagonal_long_A" scale="7 7 7 " rotation="0 10 0" auto-center></a-entity>
      <a-entity gltf-model="#tunnel" position="16.5 17 -4.5" target-part="tunnel_diagonal_long_A" scale="7 7 7 " rotation="0 5 0" auto-center></a-entity>
      <a-entity gltf-model="#tunnel" position="-24 2 2" target-part="tunnel_diagonal_short_A" scale="7 7 7 " rotation="0 90 0" auto-center></a-entity>

      <a-entity gltf-model="#spaceplateformA" position="30 -1 9"  scale="7 7 7 " rotation="0 0 0" auto-center></a-entity>
      <a-entity gltf-model="#spaceplateformB" position="-10 9.5 -26"  scale="7 7 7 " rotation="0 0 0" auto-center></a-entity>

      
      <a-entity gltf-model="#decor" target-part="terrain_slope" position="0 -1 -15" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#decor" target-part="terrain_slope" position="10 -1 -15" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#decor" target-part="terrain_slope_inner_corner" position="20 -1 -15" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#decor" target-part="terrain_slope" position="-10 -1 -15" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      <a-entity gltf-model="#decor" target-part="terrain_slope_inner_corner" position="-20 -1 -15" scale="5 5 5" rotation="0 90 0" auto-center></a-entity>
      
      <a-plane position="0 -1 -4" rotation="-90 0 0" width="100" height="100" color="#b55e2e" material="metalness: 0.2; roughness: 0.2"></a-plane>
      
      
      <a-cylinder id="drone-light" position="0 22 -10" rotation="0 0 90" scale="0.4 4 0.4" color="yellow" material="emissive: #ffdd00" light="type: point; intensity: 1; distance: 2;"></a-cylinder> 
      <a-light id="light-left" type="point" color="yellow"  position="-2 21 -10" light="type: point; intensity: 1; distance: 5;"></a-light>
      <a-light id="light-right" type="point" color="yellow"  position="2 21 -10" light="type: point; intensity: 1; distance: 5;"></a-light>
      
      
      <a-light type="ambient" color="#77A"></a-light>
      
      
      <a-sky src = "#ciel" > </a-ciel > 

        <a-light type="spot" id="drone-light" color="yellow" position="0 22 -10" intensity="0.8" angle="25" rotation="-90 0 0" penumbra="0.8"></a-light>
        
          
       
          <script src="decor.js"></script>
         
          
        

    </a-scene>
</body>
</html>

